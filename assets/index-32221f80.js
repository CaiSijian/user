import{g as u,e as p,u as I,a as S}from"./operation-71a1437a.js";function d(l){if(typeof l!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(l))}function A(l,r){for(var e="",t=0,a=-1,s=0,n,i=0;i<=l.length;++i){if(i<l.length)n=l.charCodeAt(i);else{if(n===47)break;n=47}if(n===47){if(!(a===i-1||s===1))if(a!==i-1&&s===2){if(e.length<2||t!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var o=e.lastIndexOf("/");if(o!==e.length-1){o===-1?(e="",t=0):(e=e.slice(0,o),t=e.length-1-e.lastIndexOf("/")),a=i,s=0;continue}}else if(e.length===2||e.length===1){e="",t=0,a=i,s=0;continue}}r&&(e.length>0?e+="/..":e="..",t=2)}else e.length>0?e+="/"+l.slice(a+1,i):e=l.slice(a+1,i),t=i-a-1;a=i,s=0}else n===46&&s!==-1?++s:s=-1}return e}function E(l,r){var e=r.dir||r.root,t=r.base||(r.name||"")+(r.ext||"");return e?e===r.root?e+t:e+l+t:t}var b={resolve:function(){for(var r="",e=!1,t,a=arguments.length-1;a>=-1&&!e;a--){var s;a>=0?s=arguments[a]:(t===void 0&&(t=process.cwd()),s=t),d(s),s.length!==0&&(r=s+"/"+r,e=s.charCodeAt(0)===47)}return r=A(r,!e),e?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(r){if(d(r),r.length===0)return".";var e=r.charCodeAt(0)===47,t=r.charCodeAt(r.length-1)===47;return r=A(r,!e),r.length===0&&!e&&(r="."),r.length>0&&t&&(r+="/"),e?"/"+r:r},isAbsolute:function(r){return d(r),r.length>0&&r.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var r,e=0;e<arguments.length;++e){var t=arguments[e];d(t),t.length>0&&(r===void 0?r=t:r+="/"+t)}return r===void 0?".":b.normalize(r)},relative:function(r,e){if(d(r),d(e),r===e||(r=b.resolve(r),e=b.resolve(e),r===e))return"";for(var t=1;t<r.length&&r.charCodeAt(t)===47;++t);for(var a=r.length,s=a-t,n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,o=i-n,c=s<o?s:o,g=-1,f=0;f<=c;++f){if(f===c){if(o>c){if(e.charCodeAt(n+f)===47)return e.slice(n+f+1);if(f===0)return e.slice(n+f)}else s>c&&(r.charCodeAt(t+f)===47?g=f:f===0&&(g=0));break}var w=r.charCodeAt(t+f),k=e.charCodeAt(n+f);if(w!==k)break;w===47&&(g=f)}var v="";for(f=t+g+1;f<=a;++f)(f===a||r.charCodeAt(f)===47)&&(v.length===0?v+="..":v+="/..");return v.length>0?v+e.slice(n+g):(n+=g,e.charCodeAt(n)===47&&++n,e.slice(n))},_makeLong:function(r){return r},dirname:function(r){if(d(r),r.length===0)return".";for(var e=r.charCodeAt(0),t=e===47,a=-1,s=!0,n=r.length-1;n>=1;--n)if(e=r.charCodeAt(n),e===47){if(!s){a=n;break}}else s=!1;return a===-1?t?"/":".":t&&a===1?"//":r.slice(0,a)},basename:function(r,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');d(r);var t=0,a=-1,s=!0,n;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";var i=e.length-1,o=-1;for(n=r.length-1;n>=0;--n){var c=r.charCodeAt(n);if(c===47){if(!s){t=n+1;break}}else o===-1&&(s=!1,o=n+1),i>=0&&(c===e.charCodeAt(i)?--i===-1&&(a=n):(i=-1,a=o))}return t===a?a=o:a===-1&&(a=r.length),r.slice(t,a)}else{for(n=r.length-1;n>=0;--n)if(r.charCodeAt(n)===47){if(!s){t=n+1;break}}else a===-1&&(s=!1,a=n+1);return a===-1?"":r.slice(t,a)}},extname:function(r){d(r);for(var e=-1,t=0,a=-1,s=!0,n=0,i=r.length-1;i>=0;--i){var o=r.charCodeAt(i);if(o===47){if(!s){t=i+1;break}continue}a===-1&&(s=!1,a=i+1),o===46?e===-1?e=i:n!==1&&(n=1):e!==-1&&(n=-1)}return e===-1||a===-1||n===0||n===1&&e===a-1&&e===t+1?"":r.slice(e,a)},format:function(r){if(r===null||typeof r!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof r);return E("/",r)},parse:function(r){d(r);var e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;var t=r.charCodeAt(0),a=t===47,s;a?(e.root="/",s=1):s=0;for(var n=-1,i=0,o=-1,c=!0,g=r.length-1,f=0;g>=s;--g){if(t=r.charCodeAt(g),t===47){if(!c){i=g+1;break}continue}o===-1&&(c=!1,o=g+1),t===46?n===-1?n=g:f!==1&&(f=1):n!==-1&&(f=-1)}return n===-1||o===-1||f===0||f===1&&n===o-1&&n===i+1?o!==-1&&(i===0&&a?e.base=e.name=r.slice(1,o):e.base=e.name=r.slice(i,o)):(i===0&&a?(e.name=r.slice(1,n),e.base=r.slice(1,o)):(e.name=r.slice(i,n),e.base=r.slice(i,o)),e.ext=r.slice(n,o)),i>0?e.dir=r.slice(0,i-1):a&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};b.posix=b;var m=b;window.ribbonExport=window.ribbonExport?(()=>{throw new Error})():P;function P(l){switch(l.Id){case"addWorkbook":{const e=wps.EtApplication().Workbooks.Add();let t;t=wps.EtApplication().GetSaveAsFilename();debugger;if(!t)return!1;m.basename(t)==="单词储备簿.et"?e.SaveAs(t):e.SaveAs(m.join(m.dirname(t),"单词储备簿.et"));const a=["面板","待学习单词","单词库","分析","history","parameter"];for(let g=a.length-1;g>-1;g--){const f=e.Sheets.Add(void 0,e.Sheets.Item(1));f.Name=a[g]}const s=e.Sheets;s.Item(1).Move(void 0,s.Item(a.length+1)),s.Item(1).Activate(),u("待学习单词").range("a1").formula("排除列表"),u("待学习单词").range("b1:b3").formula([["默认"],["word"],["hello"]]),u("单词库").range("a1:h1").formula([["创建时间","单词","序列数","复习序列","复习序号","复习总数","剩余复习","备注"]]),u("单词库").range("a:a").value.ColumnWidth=13,u("history").range("a1:m1").formula([["记录时间","单词","序列数","复习序列","复习序号","复习总数","剩余复习","拼写正确","拼写错误","是否记住","耗时","操作","备注"]]),u("history").range("a:a").value.ColumnWidth=13,u("parameter").range("a2").value.AddComment("单位天"),u("parameter").range("a1:b8").formula(JSON.parse('[["","复习序列"],["1","1"],["2","3"],["3","7"],["4","15"],["5","30"],["6","60"],["7","180"]]')),u("parameter").range("a1:a8").value.NumberFormatLocal='[DBNum1]"第" [$-804]G/通用格式 "次"',u("parameter").range("e1").formula("点击可以下载百度翻译"),u("parameter").value.Hyperlinks.Add(u("parameter").range("e2").value,"https://fanyi.baidu.com/appdownload/download.html?tab=desktop&fr=pcproduct"),u("parameter").range("e4").formula("艾宾浩斯wps插件安装地址"),u("parameter").value.Hyperlinks.Add(u("parameter").range("e5").value,location.origin+"/publish.html"),u("面板").range("f1:m14").value.Merge();const n=u("面板").range("f1").value;n.Value2="board",n.Font.Name="Times New Roman",n.Font.Size=72,n.HorizontalAlignment=-4108,n.Interior.Color=p.RGB(226,239,218);const i=u("面板"),o=i.range("f16"),c=i.range("f19");o.formula("今天有需要复习的单词吗？"),c.formula("今天记了几个单词？"),c.offset(1,0).Formula='=COUNTIFS(单词库!A:A,"<="&TODAY()+1,单词库!A:A,">="&TODAY())',I(),S()}break;case"Taskpane":{let e=wps.PluginStorage.getItem("taskpane_id");if(e){let t=wps.GetTaskPane(e);t.Visible=!t.Visible}else{let t=wps.CreateTaskPane(C()+"/task.html"),a=t.ID;wps.PluginStorage.setItem("taskpane_id",a),t.Visible=!0}}break;default:console.log("rebbon error");break}return!0}function C(){let l=document.location.toString();return(l=decodeURI(l)).indexOf("/")!=-1&&(l=l.substring(0,l.lastIndexOf("/"))),l}var F=0;const h={OnAddinLoad(l){return typeof wps.ribbonUI!="object"&&(wps.ribbonUI=l),typeof wps.Enum!="object"&&(wps.Enum=WPS_Enum),wps.PluginStorage.setItem("EnableFlag",!1),wps.PluginStorage.setItem("ApiEventFlag",!1),!0},OnAction(l){switch(l.Id){case"btnShowMsg":{const e=wps.EtApplication().ActiveWorkbook;if(!e){alert("当前没有打开任何文档");return}alert(e.Name)}break;case"btnIsEnbable":{let e=wps.PluginStorage.getItem("EnableFlag");wps.PluginStorage.setItem("EnableFlag",!e),wps.ribbonUI.InvalidateControl("btnIsEnbable"),wps.ribbonUI.InvalidateControl("btnShowDialog"),wps.ribbonUI.InvalidateControl("btnShowTaskPane");break}case"btnShowDialog":wps.ShowDialog(GetUrlPath()+"/ui/dialog.html","这是一个对话框网页",400*window.devicePixelRatio,400*window.devicePixelRatio,!1);break;case"btnShowTaskPane":{let e=wps.PluginStorage.getItem("taskpane_id");if(e){let t=wps.GetTaskPane(e);t.Visible=!t.Visible}else{let t=wps.CreateTaskPane(GetUrlPath()+"/ui/taskpane.html"),a=t.ID;wps.PluginStorage.setItem("taskpane_id",a),t.Visible=!0}}break;case"btnApiEvent":{let t=!wps.PluginStorage.getItem("ApiEventFlag");wps.PluginStorage.setItem("ApiEventFlag",t),t?wps.ApiEvent.AddApiEventListener("NewWorkbook",OnNewDocumentApiEvent):wps.ApiEvent.RemoveApiEventListener("NewWorkbook",OnNewDocumentApiEvent),wps.ribbonUI.InvalidateControl("btnApiEvent")}break;case"btnWebNotify":{let e=new Date,t=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();wps.OAAssist.WebNotify("这行内容由wps加载项主动送达给业务系统，可以任意自定义, 比如时间值:"+t+"，次数："+ ++F,!0)}break}return!0},GetImage(l){switch(l.Id){case"btnShowMsg":return"images/1.svg";case"btnShowDialog":return"images/2.svg";case"btnShowTaskPane":return"images/3.svg"}return"images/newFromTemp.svg"},OnGetEnabled(l){switch(l.Id){case"btnShowMsg":return!0;case"btnShowDialog":return wps.PluginStorage.getItem("EnableFlag");case"btnShowTaskPane":return wps.PluginStorage.getItem("EnableFlag")}return!0},OnGetVisible(l){return!0},OnGetLabel(l){switch(l.Id){case"btnIsEnbable":return wps.PluginStorage.getItem("EnableFlag")?"按钮Disable":"按钮Enable";case"btnApiEvent":return wps.PluginStorage.getItem("ApiEventFlag")?"清除新建文件事件":"注册新建文件事件"}return""},OnNewDocumentApiEvent(l){alert("新建文件事件响应，取文件名: "+l.Name)}};for(const l in h)window[l]=h[l];
